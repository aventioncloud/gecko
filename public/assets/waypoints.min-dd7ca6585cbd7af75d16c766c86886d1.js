!function(t,e,o,n){var i=t(n),s="waypoint.reached",r=function(t,o){t.element.trigger(s,o),t.options.triggerOnce&&t.element[e]("destroy")},l=function(t,e){if(!e)return-1;for(var o=e.waypoints.length-1;o>=0&&e.waypoints[o].element[0]!==t[0];)o-=1;return o},f=[],c=function(e){t.extend(this,{element:t(e),oldScroll:0,waypoints:[],didScroll:!1,didResize:!1,doScroll:t.proxy(function(){var e=this.element.scrollTop(),n=e>this.oldScroll,i=this,s=t.grep(this.waypoints,function(t){return n?t.offset>i.oldScroll&&t.offset<=e:t.offset<=i.oldScroll&&t.offset>e}),l=s.length;this.oldScroll&&e||t[o]("refresh"),this.oldScroll=e,l&&(n||s.reverse(),t.each(s,function(t,e){(e.options.continuous||t===l-1)&&r(e,[n?"down":"up"])}))},this)}),t(e).bind("scroll.waypoints",t.proxy(function(){this.didScroll||(this.didScroll=!0,n.setTimeout(t.proxy(function(){this.doScroll(),this.didScroll=!1},this),t[o].settings.scrollThrottle))},this)).bind("resize.waypoints",t.proxy(function(){this.didResize||(this.didResize=!0,n.setTimeout(t.proxy(function(){t[o]("refresh"),this.didResize=!1},this),t[o].settings.resizeThrottle))},this)),i.load(t.proxy(function(){this.doScroll()},this))},u=function(e){var o=null;return t.each(f,function(t,n){return n.element[0]===e?(o=n,!1):void 0}),o},h={init:function(n,i){return this.each(function(){var r,h=t.fn[e].defaults.context,p=t(this);i&&i.context&&(h=i.context),t.isWindow(h)||(h=p.closest(h)[0]),r=u(h),r||(r=new c(h),f.push(r));var a=l(p,r),d=0>a?t.fn[e].defaults:r.waypoints[a].options,y=t.extend({},d,i);y.offset="bottom-in-view"===y.offset?function(){var e=t.isWindow(h)?t[o]("viewportHeight"):t(h).height();return e-t(this).outerHeight()}:y.offset,0>a?r.waypoints.push({element:p,offset:null,options:y}):r.waypoints[a].options=y,n&&p.bind(s,n),i&&i.handler&&p.bind(s,i.handler)}),t[o]("refresh"),this},remove:function(){return this.each(function(e,o){var n=t(o);t.each(f,function(t,e){var o=l(n,e);o>=0&&(e.waypoints.splice(o,1),e.waypoints.length||(e.element.unbind("scroll.waypoints resize.waypoints"),f.splice(t,1)))})})},destroy:function(){return this.unbind(s)[e]("remove")}},p={refresh:function(){t.each(f,function(e,n){var i=t.isWindow(n.element[0]),s=i?0:n.element.offset().top,l=i?t[o]("viewportHeight"):n.element.height(),f=i?0:n.element.scrollTop();t.each(n.waypoints,function(t,e){if(e){var o=e.options.offset,i=e.offset;if("function"==typeof e.options.offset)o=e.options.offset.apply(e.element);else if("string"==typeof e.options.offset){var c=parseFloat(e.options.offset);o=e.options.offset.indexOf("%")?Math.ceil(l*(c/100)):c}e.offset=e.element.offset().top-s+f-o,e.options.onlyOnScroll||(null!==i&&n.oldScroll>i&&n.oldScroll<=e.offset?r(e,["up"]):null!==i&&n.oldScroll<i&&n.oldScroll>=e.offset?r(e,["down"]):!i&&n.element.scrollTop()>e.offset&&r(e,["down"]))}}),n.waypoints.sort(function(t,e){return t.offset-e.offset})})},viewportHeight:function(){return n.innerHeight?n.innerHeight:i.height()},aggregate:function(){var e=t();return t.each(f,function(o,n){t.each(n.waypoints,function(t,o){e=e.add(o.element)})}),e}};t.fn[e]=function(o){return h[o]?h[o].apply(this,Array.prototype.slice.call(arguments,1)):"function"!=typeof o&&o?"object"==typeof o?h.init.apply(this,[null,o]):void t.error("Method "+o+" does not exist on jQuery "+e):h.init.apply(this,arguments)},t.fn[e].defaults={continuous:!0,offset:0,triggerOnce:!1,context:n},t[o]=function(t){return p[t]?p[t].apply(this):p.aggregate()},t[o].settings={resizeThrottle:200,scrollThrottle:100},i.load(function(){t[o]("refresh")})}(jQuery,"waypoint","waypoints",window);